<!DOCTYPE html>
<html>
<head>
    <style>
        .title {
            color: white;
            text-align:center;
        }
        .sub-title{
            color: red;
            text-align:center;
        }
        .account{
            text-align:center;
        }
        .transaction{
            text-align:center;
        }
        .disabled{
            pointer-events: none;
            opacity: 0.4;
        }
    </style>
    <title>ATM</title>
</head>
<body style="background-color: black">
    <div class="title">
        <h1>ATM - Sistemas distribuidos</h1>
    </div>
    <div class="sub-title">
        <h2>Ingrese sus datos</h2>
    </div>
    <div class= "account" id="DivAccount" name="DivAccount">
        <label style="color:white">Cuenta</label><br>
        <input id="account" name="account" type="text" /> <br><br>
        <label style="color:white">Password</label><br>
        <input id="password" name="password" type="password" /> <br><br>
        <button name="btnauth" id="btnauth">Ingresar</button>
    </div>
    <div class="sub-title">
        <h2>Bienvenido, realice su transacción</h2>
    </div>
    <div class="transaction disabled" id="DivTransaction" name="DivTransaction">
        <label style="color:white">Retiro</label><br>
        <input id="withdraw" name="withdraw" type="text" /> <br>
        <button name="btnwithdraw" id="btnwithdraw">Retirar</button><br><br>
        <label style="color:white">consignación</label><br>
        <input id="consign" name="consign" type="text" /> <br>
        <button name="btnconsign" id="btnconsign">Consignar</button><br><br><br>
        <button name="btncheckBalance" id="btncheckBalance">Ver saldo</button><br><br>
    </div>
    <script src="/socket.io/socket.io.js"></script>
    <script>
        var socket = io();

        var botonIngresar = document.getElementById('btnauth');
        var seccionIngresar = document.getElementById('DivAccount');
        var seccionTransaccion = document.getElementById('DivTransaction');
        var botonRetirar = document.getElementById('btnwithdraw');
        var botonConsignar = document.getElementById('btnconsign');
        var botonSaldo = document.getElementById('btncheckBalance');

        botonIngresar.addEventListener('click',function(e){
            e.preventDefault();
            var account = document.getElementById('account').value;
            var password = document.getElementById('password').value;
            socket.emit('auth', {account:account, password:password});
        });

        socket.on('auth',function(msg){
            if(msg === "ok"){
                alert("Bienvenido al ATM")
                seccionIngresar.classList.add('disabled');
                seccionTransaccion.classList.remove('disabled');
            }else{
                alert("Datos incorrectos")
            }
        });

        botonRetirar.addEventListener('click',function(e){
            e.preventDefault();
            var montoARetirar = document.getElementById('withdraw').value;
            socket.emit('withdraw', montoARetirar);
        });

        socket.on('withdraw', function(msg){
            if(msg === "ok"){
                alert("Aquí tiene su dinero");
            }else{
                alert("Fondos insuficientes, intente de nuevo");
            }
        });

        botonConsignar.addEventListener('click', function(e){
            e.preventDefault();
            var montoAconsignar = document.getElementById('consign').value;
            socket.emit('consign', montoAconsignar);
        });

        socket.on('consign', function(msg){
            alert("Consignación exitosa");
        });

        botonSaldo.addEventListener('click', function(e){
            e.preventDefault();
            socket.emit('check');
        });

        socket.on('check',function(msg){
            alert(`Su saldo es: ${msg}`);
        });
    </script>
</body>
</html>